<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Список сокращений</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='konstruktor2.css') }}">
    <style>
        .action-button {
            background-color: #007BFF;
            color: white;
            cursor: pointer;
            padding: 10px 20px;
            font-size: 16px;
            margin-right: 10px;
            border-radius: 5px;
            border: none;
            min-width: 100px;
        }

        .action-button:hover {
            background-color: #0056b3;
        }

        .bottom-left {
            position: fixed;
            bottom: 20px;
            left: 20px;
        }

        .bottom-right {
            position: fixed;
            bottom: 20px;
            right: 20px;
        }

        /* Стили для контекстного меню */
        .context-menu {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .context-menu-item {
            padding: 8px 15px;
            cursor: pointer;
        }

        .context-menu-item:hover {
            background-color: #f5f5f5;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .page-container {
            font-family: 'Times New Roman', Times, serif;
            font-size: 12px;
        }

        .page-title {
            color: black;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="sidebar">
        <div class="header-block">
            <h3>Панель редактирования</h3>
        </div>
        
        <h4>СПИСОК СОКРАЩЕНИЙ</h4>

        <label for="abbreviation-input">Аббревиатура:</label><br />
        <input type="text" id="abbreviation-input" class="form-element" placeholder="Введите аббревиатуру"><br /><br />
        
        <label for="fullname-input">Расшифровка:</label><br />
        <input type="text" id="fullname-input" class="form-element" placeholder="Введите расшифровку"><br /><br />

        <button id="publish-button" onclick="addAbbreviation()">Сохранить</button>
    </div>

    <div class="page-container">
        <div class="page-a4">
            <h4 class="page-title">Список сокращений и условных обозначений</h4>
            <table id="editableTable">
                <tbody>
                    
                </tbody>
            </table>
        </div>
    </div>
</div>

<div id="contextMenu" class="context-menu">
    <div class="context-menu-item" onclick="editSelectedRow()">Изменить</div>
    <div class="context-menu-item" onclick="deleteSelectedRow()">Удалить</div>
</div>

<!-- Кнопка "Назад" -->
<div class="bottom-left">
    <button id="back-button" class="action-button" onclick="history.back()">Назад</button>
</div>

<!-- Кнопка "Дальше" -->
<div class="bottom-right">
    <button id="next-button" class="action-button" onclick="goToKonstruktor5Page()">Дальше</button>
</div>

<script>
    let selectedRow = null;
    let contextMenu = document.getElementById('contextMenu');

    document.addEventListener('click', function(e) {
        if (e.target !== contextMenu && !contextMenu.contains(e.target)) {
            contextMenu.style.display = 'none';
        }
    });

    document.querySelector('#editableTable tbody').addEventListener('contextmenu', function(e) {
        if (e.target.tagName === 'TD') {
            e.preventDefault();
            selectedRow = e.target.parentElement;
            
            contextMenu.style.display = 'block';
            contextMenu.style.left = e.pageX + 'px';
            contextMenu.style.top = e.pageY + 'px';
        }
    });

    function addAbbreviation() {
        const abbreviation = document.getElementById('abbreviation-input').value;
        const fullname = document.getElementById('fullname-input').value;
        
        if (abbreviation && fullname) {
            const tableBody = document.querySelector('#editableTable tbody');
            
            const newRow = document.createElement('tr');
            
            const abbreviationCell = document.createElement('td');
            abbreviationCell.textContent = abbreviation;
            abbreviationCell.style.fontWeight = 'bold';
            
            const fullnameCell = document.createElement('td');
            fullnameCell.textContent = fullname;
            
            newRow.appendChild(abbreviationCell);
            newRow.appendChild(fullnameCell);
            
            tableBody.appendChild(newRow);
            
            document.getElementById('abbreviation-input').value = '';
            document.getElementById('fullname-input').value = '';
        } else {
            alert('Пожалуйста, заполните оба поля!');
        }
    }

    function editSelectedRow() {
        if (selectedRow) {
            const cells = selectedRow.cells;
            const abbreviation = cells[0].textContent;
            const fullname = cells[1].textContent;
            
            document.getElementById('abbreviation-input').value = abbreviation;
            document.getElementById('fullname-input').value = fullname;
            
            selectedRow.remove();
            selectedRow = null;
            contextMenu.style.display = 'none';
        }
    }

    function deleteSelectedRow() {
        if (selectedRow) {
            selectedRow.remove();
            selectedRow = null;
            contextMenu.style.display = 'none';
        }
    }
    
    function goToKonstruktor5Page() {
        window.location.href = "{{ url_for('konstruktor5_page') }}";
    }
</script>

</body>
</html>